develop this work based on the work of xu